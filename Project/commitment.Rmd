---
title: "Корпус коммитмента"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

```{r libraries}
library(tidyverse)
library(FactoMineR)
library(factoextra)
library(car)
library(vcd)
library(grid)
```

### Введение
Исследования в области семантики и прагматики показывают, что глаголы, вводящие изъяснительные придаточные, по-разному выражают отношение говорящего к истинности вложенного высказывания. Глаголы вроде *знать* или *понимать* считаются фактивными, поскольку предполагают, что содержание придаточного — истина. Напротив, глаголы типа *думать* или *воображать* не обязательно передают такую уверенность. Однако деление на фактивные и нефактивные глаголы не всегда позволяет точно описать, как формируется степень коммитмента в реальной речи.

Цель настоящего исследования — выяснить, в какой мере восприятие коммитмента определяется не только семантикой главного глагола, но и другими грамматическими и синтаксическими признаками. В частности, исследование направлено на изучение следующих факторов:

- синтаксических характеристик контекста (тип союза, наличие модальности, вопроса или отрицания);
- грамматических признаков главного и вложенного глаголов (время, лицо, число, вид);
- взаимодействия этих признаков с лексическим значением глагола.

Для оценки вклада различных факторов в восприятие коммитмента используется сочетание описательных и статистических методов. На первом этапе проводится разведочный анализ, включая визуализацию распределений, исследование взаимосвязей между переменными и множественный анализ соответствий, позволяющий выявить скрытые зависимости между категориальными признаками.

На аналитическом этапе применяются непараметрические критерии для оценки различий в распределениях оценок коммитмента, а также обобщённые линейные модели для анализа влияния грамматических и синтаксических признаков. Для категориальных переменных проводится серия Хи-квадрат тестов и уточнением силы связи с помощью Cramer’s V коэффициента.

Особое внимание уделяется взаимодействиям между признаками, то есть случаям, когда влияние одного параметра варьируется в зависимости от другого, используются смешанные модели.

**Гипотезы исследования:**

1. Степень коммитмента зависит не только от семантического класса глагола, но также от грамматических характеристик конструкции.
2. Наличие модальных элементов, вопросов или отрицания снижает воспринимаемый коммитмент, независимо от лексического значения глагола.
3. Взаимодействия признаков (например, между временем, модальностью и глаголом) объясняют вариативность в восприятии коммитмента лучше, чем любые отдельные признаки.
4. Более сложные вложенные зависимости между признаками также вносят вклад в интерпретацию высказывания.

### Обзор литературы

В работе FactBank: a corpus annotated with event factuality (Sauri & Pustejovsky, 2009) описан корпус текстов, где каждое событие отмечено по степени его фактивности. Основное внимание уделяется значению глаголов — особенно тому, насколько они выражают уверенность в том, что событие произошло. Например, глаголы типа *знать* и *думать* показывают разный уровень уверенности автора. В этом подходе коммитмент воспринимается прежде всего как свойство самого глагола. В этом исследовании учитываются не только значения слов, но и грамматические и синтаксические особенности, чтобы понять, как разные факторы вместе влияют на восприятие коммитмента.

Статья Author Commitment and Social Power: Automatic Belief Tagging to Infer the Social Context of Interactions (Prabhakaran et al., 2018) посвящена автоматическому определению степени коммитмента (убеждённости автора в истинности утверждения) в текстах и его взаимосвязи с социальным статусом участников коммуникации. Авторы разработали систему аннотации высказываний по уровню коммитмента (убеждён, не убеждён, приписывает убеждение другому и т.п.) и применили её к корпусу диалогов в рабочей среде. Результаты показали, что говорящие с более низким социальным статусом чаще выражают неуверенность и уклоняются от категоричных утверждений, тогда как участники с более высоким статусом демонстрируют большую степень коммитмента. Исследование подчеркивает значимость лингвистических признаков коммитмента для анализа социальной динамики в текстах.

Статья Written Dialog and Social Power: Manifestations of Different Types of Power in Dialog Behavior (Prabhakaran et al., 2012) исследует, как различные формы социального статуса проявляются в письменной коммуникации, в том числе через выражения коммитмента. В частности, авторы показывают, что участники диалога с разным уровнем власти используют разные речевые стратегии, включая варьирование степени уверенности и обязательности своих утверждений. Коммитмент здесь рассматривается как прагматический ресурс: высокостатусные говорящие чаще выражают уверенность и утверждают информацию, в то время как низкостатусные — склонны к более осторожной или модальной формулировке. Таким образом, коммитмент анализируется в связи с социальной динамикой и коммуникативными ролями, что подчеркивает его зависимость от контекста, а не только от лексико-семантических характеристик.

### Данные
Для анализа был использован корпус, состоящий из примеров предложений с изъяснительными придаточными, в которых главным элементом выступает один из 11 глаголов. Основным источником данных являлся Национальный корпус русского языка (НКРЯ). Каждый пример включает контекст таргетного предложения и набор характеристик, описывающих его грамматическую и синтаксическую структуру.

Для каждого глагола было собрано по 100 контекстов, из них:
- 20 с модальными глаголами,
- 20 с вопросами,
- 20 с отрицаниями,
- 20 с условиями,
- 20 нейтральных.

В корпусе аннотировались следующие характеристики:

- **Источник** (НКРЯ, Тайга);
- **Контекст и таргет**: два предложения до и два после таргетного;
- **Тип контекста**: наличие модальности, вопроса, отрицания, условия или нейтральный;
- **Тип придаточной конструкции**: союзное изъяснительное или инфинитив;
- **Грамматические параметры главного глагола**: время, лицо, число, вид;
- **Грамматические параметры глагола в придаточном**: время, лицо, число, вид;
- **Оценка коммитмента**: три аннотатора выставляли рейтинги, отражающие степень уверенности говорящего в истинности придаточного высказывания.

Как таковых формальных критериев не было, при аннотации мы опирались на шкалу:
-3 (точно не p), -2 (скорее всего не p), -1 (возможно не p), 0 (нельзя определить), 1 (возможно p), 2 (скорее всего p), 3 (точно p), где p — пропозиция в зависимом предложении. Например, "Петя пожалел, что не купил торт", р — Петя не купил торт, рейтинг 3, так как, с точки зрения говорящего, точно p, точно Петя не купил торт.

Полный набор данных доступен по следующей ссылке: https://docs.google.com/spreadsheets/d/17A0Bs-fhWLigzRt7FMYnS-F5zMCvwK43gkpo34DYaZA/edit?usp=sharing.

#### Общие характеристики

```{r data}
sheet_id <- "17A0Bs-fhWLigzRt7FMYnS-F5zMCvwK43gkpo34DYaZA"
url <- sprintf("https://docs.google.com/spreadsheets/d/%s/export?format=csv", sheet_id)

comm <- read_csv(url, na = c("", "NA", "-", "―")) %>%
  mutate(id = row_number()) # добавим id сразу

# пропущенные значения
comm %>%
  summarise(across(everything(), ~sum(is.na(.))))

# дубликаты
comm %>%
  select(-id) %>%
  duplicated() %>%
  sum()

glimpse(comm)
```

```{r data1}
comm <- comm %>%
  mutate(
    Conjunction_inf = ifelse(is.na(Conjunction_inf), "inf", Conjunction_inf),
    
    # Если MatTense NA, заменить MatTense, MatPers, MatNum на "inf"
    MatPers = ifelse(is.na(MatTense), "inf", MatPers),
    MatNum = ifelse(is.na(MatTense), "inf", MatNum),
    MatTense = ifelse(is.na(MatTense), "inf", MatTense),
    
    # Если SubTense NA, заменить SubTense, SubPers, SubNum, SubAspect на "inf"
    SubPers = ifelse(is.na(SubTense), "inf", SubPers),
    SubNum = ifelse(is.na(SubTense), "inf", SubNum),
    SubAspect = ifelse(is.na(SubTense), "inf", SubAspect),
    SubTense = ifelse(is.na(SubTense), "inf", SubTense),
  )
```


```{r data2}
verb_counts <- comm %>%
  count(Verb) %>%
  mutate(Percent = n / sum(n) * 100)

ggplot(verb_counts, aes(x = n, y = reorder(Verb, n))) +
  geom_segment(aes(x = 0, xend = n, y = Verb, yend = Verb), color = "gray") +
  geom_point(color = "steelblue", size = 4) +
  geom_text(aes(label = n), nudge_x = 2, hjust = 0, size = 3.5) +
  labs(title = "Глаголы", x = "Количество", y = "Глагол") +
  theme_minimal(base_size = 12)
```

На графике показано количество собранных контекстов для каждого из 11 глаголов. Как видно, для некоторых глаголов удалось собрать по 100 примеров. Однако для нескольких глаголов собрать полный набор из 100 контекстов оказалось невозможным, во многих источниках просто не встречались предложения с коммитментом с этими глаголами. Например, для некоторых глаголов доступно меньше 20 примеров, поэтому для дальнейшего анализа из 11 глаголов были отобраны первые 7, для которых было достаточно контекстов. Остальные 4 глагола исключены из-за малого количества примеров.

```{r data3}
comm <- comm %>%
  group_by(Verb) %>%
  filter(n() >= 89) %>%
  ungroup()

# для легенды в удобном порядке с переводом
embedding_order <- c("no", "negation", "modal", "question", "conditional")
embedding_labels <- c(no = "Нейтральный", negation = "Отрицание", modal = "Модальный", question = "Вопрос", conditional = "Условный")

comm %>%
  mutate(Embedding = str_replace_all(Embedding, "[+_]", " "), Embedding = str_squish(Embedding)) %>%
  separate_rows(Embedding, sep = "\\s+") %>%
  group_by(id) %>%
  mutate(weight = 1 / n()) %>%
  ungroup() %>%
  group_by(Verb, Embedding) %>%
  summarise(n = sum(weight), .groups = "drop") %>%
  group_by(Verb) %>%
  mutate(Percent = n / sum(n) * 100) %>%
  ungroup() %>%
  mutate(Embedding = factor(Embedding, levels = embedding_order, labels = embedding_labels[embedding_order])) %>%
  ggplot(aes(x = Verb, y = n, fill = Embedding)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = paste0(round(Percent, 1), "%")),
            position = position_stack(vjust = 0.5), size = 3, color = "white") +
  labs(title = "Контексты по глаголам", x = "Глагол", y = "Количество", fill = "Контекст") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

На графике отражено общее число контекстов каждого типа для каждого глагола. Иногда в одном контексте встречаются сразу несколько типов эмбеддингов, например, question_modal_negation или question + modal. Чтобы учесть такие случаи, мы для каждого глагола сначала посчитали общее число контекстов, затем это число распределили между типами контекстов пропорционально тому, какую часть каждый тип занимает в общем количестве. Это значит, что итоговое количество контекстов для каждого глагола осталось неизменным, а внутри него мы распределили количество по типам в соответствии с их долей. В целом видно, что контекстов примерно равное количество для каждого глагола.

```{r data4}
comm %>%
  mutate(`Conjunction_inf` = replace_na(`Conjunction_inf`, "inf")) %>% # NA в данной колонке обозначал инфинитив
  count(Verb, `Conjunction_inf`, name = "n") %>%
  ggplot(aes(x = Verb, y = n, fill = `Conjunction_inf`)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(title = "Союзы по глаголам", x = "Глагол", y = "Доля", fill = "Тип") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

На графике показано распределение союзов и инфинитивов, вводящих придаточное предложение, для каждого глагола. Для большинства глаголов явно преобладает союз *что*, что соответствует типичной структуре изъяснительных предложений в русском языке. Однако для глаголов мечтать и побояться наблюдается иное распределение: у них заметно чаще встречается конструкция с инфинитивом вместо союза *что*

```{r data5}
comm <- comm %>%
  rowwise() %>%
  mutate(MeanRating = mean(c(Rating1, Rating2, Rating3))) %>% # добавим mean rating
  ungroup()

comm %>%
  add_count(Verb, name = "total_n") %>%
  filter(total_n >= 80) %>%
  mutate(Verb = factor(Verb, levels = rev(sort(unique(Verb))))) %>%
  ggplot(aes(x = Verb, y = MeanRating)) +
  geom_boxplot(fill = "lightblue", outlier.shape = 1) +
  coord_flip() +
  labs(title = "Средний рейтинг коммитмента по глаголам", x = "Глагол", y = "Средний рейтинг коммитмента") +
  theme_minimal(base_size = 12)
```

На графике представлены распределения средних рейтингов коммитмента для каждого из 7 глаголов. Видно, что глагол *догадаться* характеризуется самой высокой степенью коммитмента – значения рейтинга сосредоточены в верхней части шкалы и имеют небольшой разброс. Глаголы *узнать* и *доказать* также демонстрируют преимущественно положительные оценки, но с большим разнообразием, включая отдельные примеры с более низкими значениями. Глаголы *мечтать* и *побояться* имеют средние значения рейтинга, близкие к нейтральной зоне, с широкой вариативностью. В то время как *вообразить* и особенно *воображать* показывают отрицательные средние рейтинги, что соответствует низкому уровню коммитмента в их контекстах. Хотя у *вообразить* очень большой разброс, то есть контексты как с высокой степенью коммитмента, так и снизкой.

```{r data6}
kappa_by_verb <- comm %>%
  group_by(Verb) %>%
  summarise(FleissKappa = irr::kappam.fleiss(pick(Rating1, Rating2, Rating3))$value) %>%
  arrange(desc(FleissKappa))

kappa_by_verb
```

В таблице приведена каппа Флейсса – здесь мера согласия между тремя оценщиками. Для большинства глаголов значения каппы превышают 0,4, что свидетельствует об умеренном уровне согласия. Для глаголов *побояться* и *узнать* каппа выше 0,75, что указывает на очень хорошее согласие. Единственный глагол с каппой ниже 0,4 – *догадаться* (0,36), однако это значение всё равно близко к 0,4. При этом распределение средних рейтингов показало, что догадаться в целом характеризуется очень высокой степенью коммитмента с отдельными выбросы.

#### Главное предложение

Для анализа характеристик, связанных со временем, лицом, числом и видом были исключены инфинитивные формы, так как они требуют отдельного рассмотрения и могут иметь иные свойства.

```{r data7}
tense_order <- c("future", "present", "past")
tense_labels <- c(future = "Будущее", present = "Настоящее", past = "Прошедшее")

comm %>%
  filter(!is.na(MatTense), MatTense != "inf") %>%
  mutate(
    MatTense = factor(MatTense, levels = tense_order, labels = tense_labels[tense_order]),
    Verb = factor(Verb, levels = rev(sort(unique(Verb))))
  ) %>%
  count(Verb, MatTense, name = "Freq") %>%
  ggplot(aes(x = Verb, y = Freq, fill = MatTense)) +
  geom_bar(stat = "identity", position = "stack") +
  coord_flip() +
  labs(title = "Время глаголов", x = "Глагол", y = "Количество", fill = "Время") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

В корпусе для большинства глаголов преобладает прошедшее время, как показано на графике. Глагол *воображать* единственный представлен преимущественно настоящим временем. У глаголов *доказать* и *побояться* настоящее время не встречается вообще. Будущее время встречается у всех глаголов, кроме *воображать* и *мечтать*, но в меньшем количестве по сравнению с прошедшим и настоящим.

```{r data8}
person_order <- c("first", "second", "third")
person_labels <- c(first = "1-е лицо", second = "2-е лицо", third = "3-е лицо")

comm %>%
  filter(!is.na(MatPers), MatPers != "inf") %>%
  mutate(
    MatPers = factor(MatPers, levels = person_order, labels = person_labels[person_order]),
    Verb = factor(Verb, levels = sort(unique(Verb)))
  ) %>%
  ggplot(aes(x = MatPers, fill = MatPers)) +
  geom_bar() +
  facet_wrap(~ Verb, scales = "free_y") +
  labs(title = "Лицо глаголов", x = "", y = "", fill = "Лицо") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

График показывает, что для большинства глаголов преобладает форма в третьем лице – особенно это заметно у глаголов *догадаться*, *побояться* и *узнать*, где количество таких форм существенно превышает формы первого и второго лица. Глаголы *воображать* и *мечтать* демонстрируют относительно более равномерное распределение между тремя лицами, хотя третье лицо всё равно остаётся наиболее частотным. У глаголов *вообразить* и *мечтать* сравнительно часто встречаются формы первого лица, возможно это говорит о более субъективном характере высказываний с этими глаголами.

```{r data9}
num_order <- c("singular", "plural")
num_labels <- c(singular = "Единственное", plural = "Множественное")

comm %>%
  filter(!is.na(MatNum), MatNum != "inf") %>%
  mutate(
    MatNum = factor(MatNum, levels = num_order, labels = num_labels[num_order]),
    Verb = factor(Verb, levels = sort(unique(Verb)))
  ) %>%
  count(Verb, MatNum, name = "Freq") %>%
  filter(!is.na(MatNum)) %>%
  ggplot(aes(x = Verb, y = Freq, fill = MatNum)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Число глаголов", x = "Глагол", y = "Количество", fill = "Число") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

На графике показано, что все глаголы преимущественно употребляются в единственном числе.

Исследовать вид глагола в главном предложении в данном контексте бессмысленно, поскольку он остается неизменным для каждого конкретного глагола.

```{r data10}
comm %>%
  distinct(Verb) %>%
  mutate(Verb = factor(Verb, levels = rev(sort(unique(Verb))))) %>%
  left_join(
    comm %>%
      filter(MatTense == "inf") %>%
      mutate(Verb = factor(Verb, levels = rev(sort(unique(Verb))))) %>%
      count(Verb, name = "Count"),
    by = "Verb"
  ) %>%
  mutate(Count = replace_na(Count, 0), Clause = "Главное предложение") %>%
  ggplot(aes(x = Verb, y = Count, fill = Clause)) +
  geom_col() +
  scale_fill_brewer(palette = "Set2") +
  coord_flip() +
  labs(title = "Инфинитивы", x = "Глагол", y = "Количество") +
  theme_minimal() +
  theme(legend.position = "none")
```

В главном предложении инфинитивы встречаются очень редко и далеко не у всех глаголов, как видно на графике. Так, у глаголов *догадаться*, *побояться* и *узнать* меньше 5 инфинитивов, у глагола *воображать* чуть больше 10, и только у глагола *доказать* больше 30 инфинитивов.

#### Придаточное предложение

```{r data11}
tense_order <- c("future", "present", "past")
tense_labels <- c(future = "Будущее", present = "Настоящее", past = "Прошедшее")

comm %>%
  filter(!is.na(SubTense), SubTense != "inf") %>%
  mutate(
    SubTense = factor(SubTense, levels = tense_order, labels = tense_labels[tense_order]),
    Verb = factor(Verb, levels = rev(sort(unique(Verb))))
  ) %>%
  count(Verb, SubTense, name = "Freq") %>%
  ggplot(aes(x = Verb, y = Freq, fill = SubTense)) +
  geom_bar(stat = "identity", position = "stack") +
  coord_flip() +
  labs(title = "Время глаголов", x = "Глагол", y = "Количество", fill = "Время") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

Из графика видно, что большинство глаголов в придаточном предложении используется преимущественно в настоящем и прошедшем времени. Например, глаголы в придаточных предложениях, вводимые глаголами *воображать* и *вообразить* чаще всего встречаются в настоящем времени. Глаголы, вводимые *догадаться* и *узнать* преимущественно представлены в прошедшем времени, а будущее время у них встречается редко. Глаголы, вводимые глаголом *доказать* используются в основном в настоящем времени, при этом будущее время практически отсутствует. У *мечтать* и *побояться* немного доминирует будущее время, но в целом там преобладает инфинитив, о котором мы поговорим позже.

```{r data12}
person_order <- c("first", "second", "third")
person_labels <- c(first = "1-е лицо", second = "2-е лицо", third = "3-е лицо")

comm %>%
  filter(!is.na(SubPers), SubPers != "inf") %>%
  mutate(
    SubPers = factor(SubPers, levels = person_order, labels = person_labels[person_order]),
    Verb = factor(Verb, levels = sort(unique(Verb)))
  ) %>%
  ggplot(aes(x = SubPers, fill = SubPers)) +
  geom_bar() +
  facet_wrap(~ Verb, scales = "free_y") +
  labs(title = "Лицо глаголов", x = "", y = "", fill = "Лицо") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

На основе графика, можно отметить, что во всех случаях преобладающим является третье лицо. Использование первого лица варьируется в зависимости от глагола: например, оно сравнительно часто встречается у *вообразить* и *догадаться*, но почти отсутствует у *доказать*, *мечтать* и *побояться.* Второе лицо используется крайне редко во всех глаголах, чаще всего оно вообще отсутствует или представлено единичными примерами.

```{r data13}
num_order <- c("singular", "plural")
num_labels <- c(singular = "Единственное", plural = "Множественное")

comm %>%
  filter(!is.na(SubNum), SubNum != "inf") %>%
  mutate(
    SubNum = factor(SubNum, levels = num_order, labels = num_labels[num_order]),
    Verb = factor(Verb, levels = sort(unique(Verb)))
  ) %>%
  count(Verb, SubNum, name = "Freq") %>%
  filter(!is.na(SubNum)) %>%
  ggplot(aes(x = Verb, y = Freq, fill = SubNum)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(title = "Число глаголов", x = "Глагол", y = "Количество", fill = "Число") +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal()
```

Согласно графику, во всех глаголах придаточных предложений преобладает использование в единственном числе. Даже у глаголов с относительно большим общим числом вхождений, таких как *вообразить* и *узнать*, формы единственного числа также доминируют.

```{r data14}
aspect_order <- c("ipf", "pf")
aspect_labels <- c(ipf = "несовершенный", pf = "совершенный")

comm %>%
  filter(!is.na(SubAspect)) %>%
  mutate(
    SubAspect = factor(SubAspect, levels = aspect_order, labels = aspect_labels[aspect_order]),
    Verb = factor(Verb, levels = rev(sort(unique(Verb))))
  ) %>%
  count(Verb, SubAspect, name = "Freq") %>%
  filter(!is.na(SubAspect)) %>%
  ggplot(aes(x = Verb, y = Freq, fill = SubAspect)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  labs(
    title = "Вид глаголов",
    x = "Глагол",
    y = "Количество",
    fill = "Вид"
  ) +
  coord_flip() +
  scale_fill_brewer(palette = "Set2") +
  theme_minimal(base_size = 12)
```

По графику видно, что большинство глаголов встречаются как в совершенном, так и в несовершенном виде, однако степень преобладания того или иного вида варьируется от глагола к глаголу. Несовершенный вид преобладает у глаголов, вводимых глаголами *воображать*, *вообразить*, *догадаться*, *доказать* и *узнать*, особенно заметно это у глаголов *доказать* и *узнать.* В то же время у глаголов *мечтать* и *побояться* наблюдается обратная картина – они гораздо чаще вводят глаголы в совершенном виде.

```{r data15}
comm %>%
  distinct(Verb) %>%
  mutate(Verb = factor(Verb, levels = rev(sort(unique(Verb))))) %>%
  left_join(
    comm %>%
      filter(SubTense == "inf") %>%
      mutate(Verb = factor(Verb, levels = rev(sort(unique(Verb))))) %>%
      count(Verb, name = "Count"),
    by = "Verb"
  ) %>%
  mutate(Count = replace_na(Count, 0), Clause = "Главное предложение") %>%
  ggplot(aes(x = Verb, y = Count, fill = Clause)) +
  geom_col() +
  scale_fill_brewer(palette = "Set2") +
  coord_flip() +
  labs(title = "Инфинитивы", x = "Глагол", y = "Количество") +
  theme_minimal() +
  theme(legend.position = "none")
```

В придаточных предложениях инфинитивы встречаются намного чаще, особенно у глаголов *мечтать* и *побояться*, как видно на графике: больше 70 для обоих глаголов. Кроме того, у глагола *доказать* инфинитивы тоже встречаются очень часто – чуть меньше 50 раз, и у глагола *воображать* чуть меньше 40 раз, у глагола *узнать* единичные случаи. Для остальных глаголов инфинитивные формы в придаточных предложениях отсутствуют.

### Анализ

#### Проверка на нормальность по среднему рейтингу

```{r analysys1}
ggplot(comm, aes(sample = MeanRating)) +
  stat_qq() +
  stat_qq_line() +
  facet_wrap(~ Verb, scales = "free") +
  labs(title = "Q-Q Plots по среднему рейтингу") +
  theme_minimal()
```

```{r analysys2}
shapiro_res <- comm %>%
  group_by(Verb) %>%
  summarise(shapiro_p = if(n() >= 3 & n() <= 5000) shapiro.test(MeanRating)$p.value else NA_real_)

shapiro_res
```

По Q-Q plots видно, что выбросы сильные, но мы это еще видели при подсчете среднего рейтинга. Результаты теста Шапиро-Уилка показали, что p-value для каждого глагола значительно ниже порогового уровня 0.05, что указывает на статистически значимое отклонение распределений от нормального. Таким образом, распределения средних рейтингов по глаголам не являются нормальными.

#### Тест Крускала-Уоллиса

Для оценки влияния отдельных категориальных грамматических и синтаксических признаков на восприятие степени коммитмента высказываний применяется тест Крускала–Уоллиса. Поскольку распределение оценок коммитмента не является нормальным, этот непараметрический тест позволяет сравнить медианы распределения рейтингов между группами признаков (вид, время, число, лицо, наличие союза и др.) Целью анализа является выявление признаков, которые вносят статистически значимый вклад в различия восприятия коммитмента.

```{r analysys3}
features <- c("Embedding", "Conjunction_inf", "MatTense", "MatPers", "MatNum", "MatAspect", "SubTense", "SubPers", "SubNum", "SubAspect")

res_df <- data.frame(
  feature = character(),
  chisquared = numeric(),
  df = numeric(),
  p_value = numeric(),
  stringsAsFactors = FALSE
)

for (feature in features) {
  formula <- as.formula(paste("MeanRating ~", feature))
  test <- kruskal.test(formula, data = comm)
  
  res_df <- res_df %>%
    add_row(
      feature = feature,
      chisquared = test$statistic,
      df = test$parameter,
      p_value = test$p.value
    )
}

res_df
```

Все грамматические признаки, кроме числа главного глагола, оказывают статистически значимое влияние на восприятие коммитмента (p-value < 0.05). Особенно сильно проявляется влияние времени как у главных, так и у придаточных глаголов и вида у главных глаголов.

К недостаткам этого теста можно отнести то, что он не учитывает взаимодействия признаков и менее чувствителен, чем параметрические методы, особенно при небольших выборках.

#### Хи-квадрат

Тест Хи-квадрат применяется для проверки наличия статистически значимой зависимости между двумя категориальными переменными. В данном исследовании он помогает выявить, какие грамматические и синтаксические признаки конструкций взаимосвязаны, то есть не распределены независимо друг от друга. Это важно для понимания структуры данных, а также для корректного выбора переменных при построении моделей, чтобы избежать мультиколлинеарности и избыточности признаков. Результаты теста позволят определить, какие пары признаков тесно связаны и могут влиять друг на друга в восприятии коммитмента, а какие — являются относительно независимыми.

Сначала посмотрим, сколько для каждой пары признаков найдется ожидаемых значений меньше 5. Если это число больше 20%, то в таких случаях применять Хи-квадрат нельзя.

```{r analysys4}
features <- c("Embedding", "Conjunction_inf", "MatTense", "MatPers", "MatNum", "MatAspect", "SubTense", "SubPers", "SubNum", "SubAspect")

chi_summary_all <- data.frame(
  feature1 = character(),
  feature2 = character(),
  total = integer(),
  expected_lt5 = integer(),
  percent_lt5 = numeric(),
  stringsAsFactors = FALSE
)

for (i in 1:(length(features) - 1)) {
  for (j in (i + 1):length(features)) {
    f1 <- features[i]
    f2 <- features[j]
    
    tbl <- table(comm[[f1]], comm[[f2]])

    chi_res <- suppressWarnings(chisq.test(tbl))
    exp <- chi_res$expected
    tot <- length(exp)
    lt5 <- sum(exp < 5)
    perc_lt5 <- round(100 * lt5 / tot, 2)
    
    chi_summary_all <- rbind(chi_summary_all, data.frame(
      feature1 = f1,
      feature2 = f2,
      total = tot,
      expected_lt5 = lt5,
      percent_lt5 = perc_lt5
    ))
  }
}

chi_summary_all
```

Получается возьмем следующие пары: MatTense — MatPers, MatTense — MatAspect, MatTense — SubTense, MatTense — SubPers, MatTense — SubAspect, MatPers — MatAspect, MatPers — SubTense, MatPers — SubPers, MatPers — SubAspect, MatAspect — SubTense, MatAspect — SubPers, MatAspect — SubAspect, SubTense — SubPers, SubTense — SubAspect, SubPers — SubAspect.

```{r analysys5}
pairs_to_test <- list(
  c("MatTense", "MatPers"),
  c("MatTense", "MatAspect"),
  c("MatTense", "SubTense"),
  c("MatTense", "SubPers"),
  c("MatTense", "SubAspect"),
  c("MatPers", "MatAspect"),
  c("MatPers", "SubTense"),
  c("MatPers", "SubPers"),
  c("MatPers", "SubAspect"),
  c("MatAspect", "SubTense"),
  c("MatAspect", "SubPers"),
  c("MatAspect", "SubAspect"),
  c("SubTense", "SubPers"),
  c("SubTense", "SubAspect"),
  c("SubPers", "SubAspect")
)

results <- data.frame(
  feature1 = character(),
  feature2 = character(),
  chi_squared = numeric(),
  df = numeric(),
  p_value = numeric(),
  stringsAsFactors = FALSE
)

for (pair in pairs_to_test) {
  f1 <- pair[1]
  f2 <- pair[2]
  
  tbl <- table(comm[[f1]], comm[[f2]])
  
  test <- chisq.test(tbl)
  results <- rbind(results, data.frame(
    feature1 = f1,
    feature2 = f2,
    chi_squared = test$statistic,
    df = test$parameter,
    p_value = test$p.value
  ))
}

results
```

Все p-value очень малы (намного меньше 0.05), следовательно отклоненяем гипотезу о независимости. Особенно сильно зависимы признаки в главном предложении между собой, в частности со времнем (то есть MatTense — MatPers, MatTense — MatAspect), и признаки в придаточном предложении (то есть SubTense — SubPers, SubTense — SubAspect, SubPers — SubAspect). Кроме того, признак SubAspect связан со всеми признаками главного предложения довольлно сильно, не считая MatAspect (с ним тоже связан, но поменьше). Эти результаты подтверждают, что при анализе восприятия коммитмента нужно учитывать взаимодействия между грамматическими признаками, так как они не независимы.

Основные ограничения теста хи-квадрат связаны с требованием достаточного объёма выборки и размером ожидаемых частот — они должны быть не слишком малы (обычно не меньше 5), иначе результаты могут быть ненадёжными. Кроме того, тест не показывает силу или направление зависимости, а лишь факт её наличия. Наконец, он применим только к категориальным данным и не учитывает порядок или количественные значения переменных.

#### Cramér's V

Коэффициент Cramér's V используется для оценки силы связи между категориальными переменными. В данном исследовании он дополняет результаты Хи-квадрат тестов между признаками, помогая понять, насколько выражены обнаруженные зависимости. Ожидается, что для некоторых пар признаков (например, время и вид) связь будет умеренной или сильной, что укажет на их функциональную связанность, тогда как слабые значения при значимом Хи-квадрате покажут, что эффект обусловлен лишь размером выборки.

```{r analysys6}
features <- c("Embedding", "Conjunction_inf", "MatTense", "MatPers", "MatNum", "MatAspect", "SubTense", "SubPers", "SubNum", "SubAspect")

cramers_v <- function(x, y) {
  idx <- complete.cases(x, y)
  x <- factor(x[idx])
  y <- factor(y[idx])
  tab <- table(x, y)
  assocstats(tab)$cramer
}

res <- matrix(NA, nrow=length(features), ncol=length(features))
rownames(res) <- colnames(res) <- features

for (i in seq_along(features)) {
  for (j in seq_along(features)) {
    if (i != j) {
      res[i,j] <- cramers_v(comm[[features[i]]], comm[[features[j]]])
    }
  }
}

round(res, 3)
```

Внутри группы признаков главного предложения (MatTense, MatPers, MatNum, MatAspect) и внутри группы признаков подчинённого предложения (SubTense, SubPers, SubNum, SubAspect) наблюдается средняя или сильная взаимосвязь (0.4–0.6). Между же этими двумя группами связи слабее (обычно 0.1–0.3), что указывает на относительную независимость грамматических характеристик главного и подчинённого предложения. Переменные Embedding и Conjunction_inf демонстрируют слабую или умеренную связь с остальными признаками (0.19–0.4), что свидетельствует о том, что они связаны с грамматическими характеристиками, но менее тесно.

Cramér's V показывает лишь силу связи между категориальными переменными, но не её направление. При большом числе категорий и несбалансированных данных результаты могут быть менее надёжными.

#### Multiple Correspondence Analysis

Multiple Correspondence Analysis используется для изучения и визуализации взаимосвязей между несколькими категориальными переменными одновременно. В данном исследовании MCA помогает выявить скрытые структуры и паттерны в грамматических и синтаксических характеристиках, а также показать, какие комбинации признаков чаще всего встречаются вместе. Ожидается, что анализ позволит наглядно представить взаимодействия между переменными и поможет лучше понять, какие сочетания факторов влияют на восприятие коммитмента.

```{r analysys7}
comm_mca_data <- comm %>%
  select(Embedding, `Conjunction_inf`, MatTense, MatPers, MatNum, MatAspect, SubTense, SubPers, SubNum, SubAspect) %>%
  mutate(across(everything(), ~replace_na(as.character(.), "missing"))) %>%
  mutate(across(everything(), as.factor))

mca_res <- MCA(comm_mca_data, graph = FALSE)

fviz_mca_var(mca_res,
             select.var = list(contrib = 40),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             ggtheme = theme_minimal())

fviz_mca_var(mca_res, axes = c(3, 4),
             select.var = list(contrib = 30),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             ggtheme = theme_minimal())
```

Первые 2 измерения объяснют примерно 14% дисперсии, что, конечно, мало, но для MCA с большим количеством перемнных в целом нормально. Самое заметное это то, что признаки с инфинитивами очень близки и вносят наибольший вклад, особеено в главном предложении. При визуализации 3 и 4 размерности наибольший вклад уже вносят не инфинитивы, но какие-то выводы о других признаках сделать сложно. Единственное число выделяется в отдельную группу, наибольший вклад вносят время и вид, но они расположены смешано с другими признаками. Еще логично, что второе лицо вносит больший вклад, чем первое и третье, и у главного предложения, и у придаточного, так как оно встречается реже. Стоит посмотреть еще на MCA без инфинитива, подтверждение, что инфинитивы близки друг к другу интересно, но еще лучше посмотреть на другие переменные:

```{r analysys8}
comm_mca_data <- comm %>%
  filter(MatTense != "inf", MatPers != "inf", MatNum != "inf", SubTense != "inf", SubPers != "inf", SubNum != "inf") %>%
  select(Embedding, Conjunction_inf, MatTense, MatPers, MatNum, MatAspect, SubTense, SubPers, SubNum, SubAspect) %>%
  mutate(across(everything(), ~replace_na(as.character(.), "missing"))) %>%
  mutate(across(everything(), as.factor))

mca_res <- MCA(comm_mca_data, graph = FALSE)

fviz_mca_var(mca_res,
             select.var = list(contrib = 80),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             ggtheme = theme_minimal())

fviz_mca_var(mca_res, axes = c(3, 4),
             select.var = list(contrib = 40),
             repel = TRUE,
             col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             ggtheme = theme_minimal())
```

Первые два измерения объясняют еще меньше – 11% дисперсии. По выводам получается то же самое, что и для 3 и 4 измерений на предыдущей визуализации с инфинитивами. 

Недостатки MCA включают сложность интерпретации при большом числе категорий и низкую долю объяснённой дисперсии первых компонентов. Кроме того, метод чувствителен к редким категориям, что может влиять на точность визуализации.

#### Модель

Модель используется для выявления и количественной оценки влияния грамматических и синтаксических характеристик на восприятие коммитмента (MeanRating). Ожидается, что включённые переменные объяснят значительную часть вариативности в оценках, а значимые коэффициенты покажут, какие именно факторы и в каком направлении влияют на восприятие коммитмента.

Для оценки мультиколлинеарности был использован коэффициент VIF (Variance Inflation Factor), который рассчитывается на основе линейной модели. Несмотря на то, что в основном анализе используется обобщённая линейная модель (GLM), проверку VIF принято проводить на обычной линейной модели (LM). Линейная модель здесь использовалась исключительно как технический шаг для оценки допустимости включения переменных. Проверка показала, что для выбранных признаков уровень мультиколлинеарности допустим, и они могут быть включены в модель как независимые предикторы.

Для проверки влияния грамматических и синтаксических признаков на восприятие коммитмента была построена обобщённая линейная модель (GLM) с семейством gaussian. Несмотря на то, что нормальность остатков является одной из формальных предпосылок для такой модели, её нарушение не считается критичным при больших объёмах данных. В данном случае размер выборки (697) позволяет полагаться на устойчивость оценок даже при возможных отклонениях от нормального распределения ошибок, тем более наша цель — оценка вклада предикторов, а не прогноз.

В модель включены только следующие признаки: Embedding, Conjunction_inf, MatTense, MatAspect, SubTense и SubAspect. Это связано с тем, что в целом многие признаки сильно взаимозависимы, но именно эти перемнные было интереснее всего посмотреть, и проверка VIF показала, что мультиколлинеарности между ними нет или она несущественна.

```{r analysys9}
model <- lm(MeanRating ~ Embedding + Conjunction_inf + MatTense + MatAspect + SubTense + SubAspect, data = comm)
vif(model)

model_glm <- glm(MeanRating ~ Embedding + Conjunction_inf + MatTense + MatAspect + SubTense + SubAspect, data = comm, family = gaussian())
shapiro.test(residuals(model_glm))
summary(model_glm)
```

Значимыми предикторами (p < 0.05) оказались отдельные сочетания признаков в переменной Embedding, а также конкретные значения союзов (будто) и вида главного глагола (pf). В частности:
1. Embeddingnegation, Embeddingnegation + modal, Embeddingno, и Embeddingquestion + modal положительно и значимо связаны с более высокой оценкой коммитмента.
2. Embeddingconditional + modal снижает оценку коммитмента (отрицательный коэффициент), также значимо.
3. Conjunction_infбудто показывает отрицательное влияние на MeanRating.
4. MatAspectpf (совершенный вид у главного глагола) значительно увеличивает воспринимаемый коммитмент.

Некоторые признаки приближаются к порогу значимости (например, SubTensepast, MatTensepresent, Embeddingmodal + conditional).

Модель объясняет примерно 30% дисперсии (по сравнению с null deviance) и является статистически значимой. Однако, несмотря на наличие значимых коэффициентов, общая интерпретация модели требует осторожности: взаимозависимость признаков, а также возможная мультиколлинеарность (хотя и проверенная с помощью VIF), могут влиять на стабильность оценок.

### Дискуссия

Распределение средних рейтингов существенно отклоняется от нормального, что подтверждается тестом Шапиро-Уилка и Q-Q графиками с выраженными выбросами. В связи с этим применялись непараметрические методы анализа.

Тест Крускала-Уоллиса выявил влияние времени и вида глаголов, что связано с тем, что временные характеристики показывают степень завершённости или актуальности действия, а вид — аспектуальные свойства, которые могут влиять на степень утверждения высказывания. Тесты Хи-квадрат и коэффициент Cramér's V показали высокую взаимосвязь признаков внутри главного и придаточного предложений, что соответствует грамматической и синтаксической близости этих групп признаков. Между группами связь слабее, что может объясняться разной функциональной ролью главного и придаточного предложения.

Результаты множественного факторного анализа, где инфинитивные формы и числовые категории вносят заметный вклад, могут указывать на то, что эти признаки служат своеобразными маркерами синтаксических структур, которые по-разному влияют на восприятие коммитмента.

Регрессионная модель выявила значимые эффекты определённых грамматических конструкций и видов глаголов. Например, отрицание и модальность, по-видимому, играют важную роль в изменении восприятия степени уверенности.

Дальнейшие направления развития проекта могут включать расширение анализа с использованием более сложных статистических моделей, например, иерархических или смешанных моделей, которые позволят учитывать вложенную структуру данных и взаимодействия на разных уровнях. Также можно обратить внимание на методы машинного обучения для автоматического выявления и интерпретации паттернов в грамматических и синтаксических признаках, влияющих на восприятие коммитмента. Кроме того, расширение корпуса данных позволит проверить универсальность выявленных закономерностей и адаптировать модели под более широкий спектр лингвистических контекстов.

### Заключение

В ходе исследования было подтверждено, что степень коммитмента зависит не только от семантического класса глагола, но и от грамматических характеристик конструкции. Анализ показал значимую роль времени и вида глаголов, а также взаимодействия между грамматическими признаками главного и придаточного предложений.

Что касается влияния модальных элементов, вопросов и отрицания, результаты оказались более сложными, чем предполагалось. Условные конструкции с модальностью связаны со снижением восприятия коммитмента, однако отрицание чаще сопровождается повышением оценки коммитмента. Это свидетельствует о том, что влияние модальности и отрицания зависит от конкретного сочетания признаков и контекста, и не может рассматриваться однозначно.

Взаимодействия между признаками, особенно между временем, модальностью и видом глаголов, оказывают существенное влияние на вариативность восприятия коммитмента. Более того, сложные вложенные зависимости между признаками, выявленные в модели, подтверждают важность учета таких взаимодействий для интерпретации коммитмента высказываний.

Таким образом, полученные результаты поддерживают гипотезы о комплексной природе факторов, влияющих на коммитмент, и указывают на необходимость учитывать грамматические характеристики и их взаимосвязи при исследовании восприятия степени коммитмента в языковых конструкциях.

### Литература

1. Roser Sauri and James Pustejovsky. 2009. Fact-Bank: a corpus annotated with event factuality. Language Resources and Evaluation 43:227–268.
2. Vinodkumar Prabhakaran, Premkumar Ganeshkumar, and Owen Rambow. 2018. Author commitment and social power: Automatic belief tagging to infer the social context of interactions. In Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers), New Orleans, Louisiana, pages 1057-1068.
3. Vinodkumar Prabhakaran and Owen Rambow. 2013. Written Dialog and Social Power: Manifestations of Different Types of Power in Dialog Behavior. In Proceedings of the IJCNLP. Asian Federation of Natural Language Processing, Nagoya, Japan, pages 216–224.














